<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1"><meta name=description><meta name=keywords content="Freelance developer, Edinburgh, mobile, web, Android, iOS, Wordpress, AngularJS, PhoneGap, SEO, Heroku, AWS, Google Apps, JavaScript"><title>Solution: Themes and widgets showing multiple languages when using WPML WordPress plugin - Sean Wilson, Web and Mobile Developer, Edinburgh, UK</title><link rel=icon type=image/png href=/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=canonical href=https://www.seanw.org/blog/themes-and-widgets-showing-multiple-languages-wpml><link rel=stylesheet href=/css/styles.css><link href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,700,300,400" rel=stylesheet type=text/css></head><body><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav navbar-right2"><li><a href="/">Home</a></li><li><a href=/#services>Services</a></li><li><a href=/#portfolio>Portfolio</a></li><li><a href=/#endorsements>Endorsements</a></li><li><a href=/#contact>Contact</a></li><li><a href="/blog/">Blog</a></li></ul></div></div></nav><div itemscope itemtype=http://schema.org/Person><header class=intro-header style="background-image: url('/img/site-header.jpg');"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=site-heading><a itemprop=url href="/"><h1 itemprop=name>Sean Wilson</h1></a><h2><span itemprop=jobTitle>Freelance web and mobile developer</span> - <span itemscope itemtype=http://schema.org/PostalAddress itemprop=address><span itemprop=addressLocality>Edinburgh</span>, <span itemprop=addressCountry>UK</span></span></h2></div></div></div></div></header><div class=container2><div class="container2 text-center"><img itemprop=image src=/img/avatar.png class="wowx bounceInDown" style="width: 120px; margin-left: auto; margin-right: auto; margin-top:-70px; z-index: 100;" alt="Photo of Sean Wilson"></div><div class=section><div class=section-content><h1>Solution: Themes and widgets showing multiple languages when using WPML WordPress plugin</h1><h2 class=subheading></h2><span class=meta>January 27, 2015</span><h2 id=wordpress-multilingual-plugin-wpml>WordPress Multilingual plugin (WPML)</h2><p>The <a href="http://wpml.org/">WordPress Multilingual (WPML)</a> plugin offers a comprehensive solution for transitioning from a single language <a href="https://wordpress.org/">WordPress</a> website to one that supports multiple languages. Once installed, you can add several translations of individual posts and custom posts from within the WordPress admin interface. When viewing a page for a specific language on your site, page content is then generated by pulling in posts for the current language.</p><h2 id=problem-theme-and-widgets-showing-multiple-languages>Problem: Theme and widgets showing multiple languages</h2><p>Many themes and plugins will work out of the box with WPML but a common problem is themes and plugins will display content for all languages instead of only the current one. For example, I’ve worked with sites that use the <a href="http://www.woothemes.com/products/canvas/">Canvas theme</a> from <a href="http://www.woothemes.com/products/canvas/">WooThemes</a> which mostly works with WPML but has a few multilingual usage problems. The bundled widget that shows custom posts to create a slideshow works with WPML in the way you’d expect but the widget that shows custom posts to display customer feedback quotes will show a mixture of languages. This led to a French site showing feedback in both French and English!</p><h2 id=solution-set-suppressfilters-to-false>Solution: Set <code>suppress_filters</code> to <code>false</code></h2><p>A common cause of this is the <code>suppress_filters</code> flag being set to <code>true</code> in the PHP code for the theme or widget that queries for posts to show. This flag tells WordPress to ignore custom filters that plugins apply when querying for posts. WPML add its own filter so that queries will only return posts for the current language. However, there are several ways to query for posts that will inadvertently disable this filter which causes the above problem of posts from all languages being shown. A frequent source of this issue is the <a href=http://codex.wordpress.org/Template_Tags/get_posts><code>get_posts</code></a> function. By default, <code>get_posts</code> sets <code>suppress_filters</code> to <code>true</code> which disables WPML’s filters! Other querying functions like <a href=http://codex.wordpress.org/Function_Reference/query_posts>query_posts</a> set <code>suppress_filters</code> to <code>false</code> by default so will work with WPML as you’d expect.</p><p>The solution to fixing the Canvas theme feedback widget was first to locate the PHP code that generated the HTML shown on the frontend and work backwards to find the WordPress query that gathered the list of feedback posts to show. I found the query was being performed by a call to <code>get_posts</code>. After setting the <code>suppress_filters</code> flag to <code>false</code> for this query when calling this function, the widget correctly showed posts only for the current language.</p><ul class=pager><li class=previous><a href=/blog/hide-own-traffic-in-google-analytics data-toggle=tooltip data-placement=top title="Hiding visits to your own site in Google Analytics">&larr; Previous Post</a></li><li class=next><a href=/blog/download-git-repo-subdirectory data-toggle=tooltip data-placement=top title="Download a Git subdirectory from GitHub">Next Post &rarr;</a></li></ul><div id=disqus_thread></div><script type=text/javascript>
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'wwwseanworg'; // required: replace example with your forum shortname

                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
                </script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=/feed.xml><i class="fa fa-rss fa-2x fa-inverse"></i></a></li><li><a href=https://plus.google.com/104668619020025614954 rel=publisher><i class="fa fa-google-plus fa-2x fa-inverse"></i></a></li><li><a href=https://github.com/seanw><i class="fa fa-github fa-2x fa-inverse"></i></a></li><li><a href="http://uk.linkedin.com/in/seanwilsonuk/"><i class="fa fa-linkedin fa-2x fa-inverse"></i></a></li><li><a href=mailto:sw@seanw.org><i class="fa fa-envelope fa-2x fa-inverse"></i></a></li></ul><p class="copyright text-muted">Copyright &copy; Sean Wilson 2015</p></div></div></div></footer></div></body><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-50152236-1', 'auto');
ga('require', 'displayfeatures');
ga('send', 'pageview');
</script><script type=text/javascript src=/js/scripts.js></script></html>