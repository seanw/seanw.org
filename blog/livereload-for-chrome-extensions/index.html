<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1"><meta name=description><meta name=keywords content="Freelance developer, Edinburgh, mobile, web, Android, iOS, Wordpress, AngularJS, PhoneGap, SEO, Heroku, AWS, Google Apps, JavaScript"><title>LiveReload for Chrome extensions with Gulp - Sean Wilson, Web &amp; Mobile App Developer - Edinburgh, UK</title><link rel=icon type=image/png href=/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel="shortcut icon" href=favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=favicons/favicon-32x32.png><link rel=canonical href="https://www.seanw.org/blog/livereload-for-chrome-extensions/"><link rel=publisher href=https://plus.google.com/104547302048905734327><link href=/css/styles3.css?1547314726354077000 rel=stylesheet><link href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css rel=stylesheet type=text/css><link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,700,100,300" rel=stylesheet><script type=application/ld+json>{ "@context" : "http://schema.org", "@type" : "Organization", "name" : "Sean Wilson - Web and mobile developer - Edinburgh, UK", "address": "Edinburgh, UK", "url" : "https://www.seanw.org", "logo": "https://www.seanw.org/img/site-header.jpg", "email" : "sw@seanw.org", "sameAs" : [ "https://plus.google.com/104547302048905734327", "https://www.twitter.com/seanw_uk", "https://github.com/seanw" ], "contactPoint" : [{ "@type" : "ContactPoint", "email" : "sw@seanw.org", "url" : "https://www.seanw.org", "contactType" : "customer service" }] }</script></head><body><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav navbar-right2"><li><a href="/">Home</a></li><li><a href=/#services>Services</a></li><li><a href=/#portfolio>Portfolio</a></li><li><a href=/#endorsements>Endorsements</a></li><li><a href=/#contact>Hire me</a></li><li><a href="/blog/">Blog</a></li></ul></div></div></nav><div itemscope itemtype=http://schema.org/Person><header class=intro-header style="background-image: url('/img/site-header.jpg');"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=site-heading><a itemprop=url href="/"><h1 itemprop=name>Sean Wilson</h1></a><h2><span itemprop=jobTitle>Freelance web &amp; mobile app developer</span> - <span itemscope itemtype=http://schema.org/PostalAddress itemprop=address><span itemprop=addressLocality>Edinburgh</span>, <span itemprop=addressCountry>UK</span></span></h2></div></div></div></div></header><img itemprop=image src=/img/avatar.jpg class="img-circle img-avatar"><div class=section><div class=section-content><h1>LiveReload for Chrome extensions with Gulp</h1><h2 class=subheading></h2><span class=meta>November 15, 2015</span><p>LiveReload is a fantastic feature to add to your development workflow to increase your productivity. The general idea is that when a change occurs to a file that makes up your app, your app is automatically rebuilt and the app restarts itself. This saves you from manually rebuilding and restarting your app each time you make a change and generally makes development much more pleasant.</p><p>There are LiveReload implementations available for many languages and frameworks such as <a href=https://github.com/mklabs/tiny-lr>tiny-lr</a> which can be used with <a href="http://gulpjs.com/">Gulp</a> for web development. However, I recently found the standard way of using tiny-lr does not work when developing Chrome extensions without a slight change.</p><p>To get started, you need to create a <code>gulpfile.js</code> file containing something like the following:</p><figure class=highlight><pre><code class=language-javascript data-lang=javascript><span></span><span class=kd>var</span> <span class=nx>gulp</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;gulp&#39;</span><span class=p>);</span>
<span class=kd>var</span> <span class=nx>tinyLr</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;tiny-lr&#39;</span><span class=p>);</span>

<span class=nx>gulp</span><span class=p>.</span><span class=nx>task</span><span class=p>(</span><span class=s1>&#39;watch&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>liveReload</span> <span class=o>=</span> <span class=nx>tinyLr</span><span class=p>();</span>
    <span class=nx>liveReload</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>35729</span><span class=p>);</span>
    <span class=nx>gulp</span><span class=p>.</span><span class=nx>watch</span><span class=p>([</span><span class=s1>&#39;**/*.css&#39;</span><span class=p>,</span> <span class=s1>&#39;**/*.html&#39;</span><span class=p>,</span> <span class=s1>&#39;**/*.js&#39;</span><span class=p>],</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>watchEvent</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>watchEvent</span><span class=p>);</span>
        <span class=nx>liveReload</span><span class=p>.</span><span class=nx>changed</span><span class=p>({</span>
            <span class=nx>body</span><span class=o>:</span> <span class=p>{</span>
                <span class=nx>files</span><span class=o>:</span> <span class=p>[</span><span class=nx>watchEvent</span><span class=p>.</span><span class=nx>path</span><span class=p>]</span>
            <span class=p>}</span>
        <span class=p>});</span>
    <span class=p>});</span>
<span class=p>});</span></code></pre></figure><p>When you run <code>gulp watch</code> a tiny-lr server is started which will communicate between the Gulp task and your app. The Gulp task then watches the current folder and subfolders for any changes to <code>css</code>, <code>html</code> and <code>js</code> files. If a change is detected, the tiny-lr server is notified.</p><p>The next stage in the process when a change is identified is that tiny-lr should instruct your app to restart. To create the link between tiny-lr and your app, you normally include a tiny-lr script at startup in your app using the following snippet:</p><figure class=highlight><pre><code class=language-html data-lang=html><span></span><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&quot;http://localhost:35729/livereload.js&quot;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></code></pre></figure><p>However, due to the increased security restrictions of Chrome extensions, you’ll see this error message on startup:</p><pre><code>Refused to load the script 'http://localhost:35729/livereload.js' because it violates the following Content Security Policy directive: "script-src 'self' 'unsafe-eval'".
</code></pre><p>The problem is you cannot load external JavaScript files without <a href=https://developer.chrome.com/extensions/contentSecurityPolicy#relaxing-remote-script>whitelisting secure script locations</a>. However, there’s a simpler alternative.</p><p>In the <code>node-modules</code> folder that tiny-lr is installed under, you can find the above tiny-lr script our app was trying to load via tiny-lr’s server in the file <code>node_modules/tiny-lr/node_modules/livereload-js/dist/livereload.js</code>. To work around the external JavaScript loading issue, we can instead load this file directly.</p><p>One last piece in the puzzle is the script needs to know the host and port of the tiny-lr server. This information can be set via URL parameters. The working <code>script</code> tag to include in your app is then as follows:</p><figure class=highlight><pre><code class=language-html data-lang=html><span></span><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&quot;node_modules/tiny-lr/node_modules/livereload-js/dist/livereload.js?host=localhost&amp;port=35729&quot;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></code></pre></figure><p>Now whenever you edit a development file, your Chrome extension should automatically reload itself. Happy developing!</p><div class="text-center frame" style="xfont-weight:800; padding: 0 25px;"><p><span class=faded>Previous post</span><br><b><a href="/blog/publicly-host-and-share-websites-on-google-drive/">Google Drive: Publicly hosting a static website</a></b></p><p><span class=faded>Next post</span><br><b><a href="/blog/checkbot-for-chrome-public-beta/">Checkbot for Chrome: Public beta</a></b></p></div><div class="wow zoomIn frame call-to-action"><i>Looking for an experienced full stack developer for your web or mobile project?</i><br><a href="/">I'm available for contract work</a> in Edinburgh and can also work remotely.</div><div id=disqus_thread></div><script type=text/javascript>
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'wwwseanworg'; // required: replace example with your forum shortname

                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
                </script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:sw@seanw.org><i class="fa fa-envelope fa-inverse"></i> <span class=sr-only>Email</span></a></li><li><a href=https://twitter.com/seanw_uk><i class="fa fa-twitter fa-inverse"></i> <span class=sr-only>Twitter profile</span></a></li><li><a href="http://uk.linkedin.com/in/seanwilsonuk/"><i class="fa fa-linkedin fa-inverse"></i> <span class=sr-only>LinkedIn</span></a></li><li><a href=https://plus.google.com/104547302048905734327 rel=publisher><i class="fa fa-google-plus fa-inverse"></i> <span class=sr-only>Google+ profile</span></a></li><li><a href=https://github.com/seanw><i class="fa fa-github fa-inverse"></i> <span class=sr-only>GitHub profile</span></a></li><li><a href=/feed.xml><i class="fa fa-rss fa-inverse"></i> <span class=sr-only>RSS feed</span></a></li></ul><p class="copyright text-muted">Copyright &copy; Sean Wilson 2019. Header photo modified from work by Martin Stiburek (CC BY-SA 4.0 license).</p></div></div></div></footer></div></body><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-50152236-1', 'auto');
ga('require', 'displayfeatures');
ga('send', 'pageview');
</script><script type=text/javascript src=/js/scripts.js></script></html>