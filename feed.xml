<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sean Wilson, Web and Mobile Developer, Edinburgh, UK</title>
    <description></description>
    <link>https://www.seanw.org/</link>
    <atom:link href="https://www.seanw.org/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Wed, 28 Jan 2015 18:15:15 +0000</pubDate>
    <lastBuildDate>Wed, 28 Jan 2015 18:15:15 +0000</lastBuildDate>
    <generator>Jekyll v2.5.2</generator>
    
      <item>
        <title>Solution: Themes and widgets showing multiple languages when using WPML WordPress plugin</title>
        <description>&lt;h2 id=&quot;wordpress-multilingual-plugin-wpml&quot;&gt;WordPress Multilingual plugin (WPML)&lt;/h2&gt;

&lt;p&gt;The &lt;a href=&quot;http://wpml.org/&quot;&gt;WordPress Multilingual (WPML)&lt;/a&gt; plugin offers a comprehensive solution for transitioning from a single language &lt;a href=&quot;https://wordpress.org/&quot;&gt;WordPress&lt;/a&gt; website to one that supports multiple languages. Once installed, you can add several translations of individual posts and custom posts from within the WordPress admin interface. When viewing a page for a specific language on your site, page content is then generated by pulling in posts for the current language.&lt;/p&gt;

&lt;h2 id=&quot;problem-theme-and-widgets-showing-multiple-languages&quot;&gt;Problem: Theme and widgets showing multiple languages&lt;/h2&gt;

&lt;p&gt;Many themes and plugins will work out of the box with WPML but a common problem is themes and plugins will display content for all languages instead of only the current one. For example, I’ve worked with sites that use the &lt;a href=&quot;http://www.woothemes.com/products/canvas/&quot;&gt;Canvas theme&lt;/a&gt; from &lt;a href=&quot;http://www.woothemes.com/products/canvas/&quot;&gt;WooThemes&lt;/a&gt; which mostly works with WPML but has a few multilingual usage problems. The bundled widget that shows custom posts to create a slideshow works with WPML in the way you’d expect but the widget that shows custom posts to display customer feedback quotes will show a mixture of languages. This led to a French site showing feedback in both French and English!&lt;/p&gt;

&lt;h2 id=&quot;solution-set-suppressfilters-to-false&quot;&gt;Solution: Set &lt;code&gt;suppress_filters&lt;/code&gt; to &lt;code&gt;false&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;A common cause of this is the &lt;code&gt;suppress_filters&lt;/code&gt; flag being set to &lt;code&gt;true&lt;/code&gt; in the PHP code for the theme or widget that queries for posts to show. This flag tells WordPress to ignore custom filters that plugins apply when querying for posts. WPML add its own filter so that queries will only return posts for the current language. However, there are several ways to query for posts that will inadvertently disable this filter which causes the above problem of posts from all languages being shown. A frequent source of this issue is the &lt;a href=&quot;http://codex.wordpress.org/Template_Tags/get_posts&quot;&gt;&lt;code&gt;get_posts&lt;/code&gt;&lt;/a&gt; function. By default, &lt;code&gt;get_posts&lt;/code&gt; sets &lt;code&gt;suppress_filters&lt;/code&gt; to &lt;code&gt;true&lt;/code&gt; which disables WPML’s filters!  Other querying functions like &lt;a href=&quot;http://codex.wordpress.org/Function_Reference/query_posts&quot;&gt;query_posts&lt;/a&gt; set &lt;code&gt;suppress_filters&lt;/code&gt; to &lt;code&gt;false&lt;/code&gt; by default so will work with WPML as you’d expect.&lt;/p&gt;

&lt;p&gt;The solution to fixing the Canvas theme feedback widget was first to locate the PHP code that generated the HTML shown on the frontend and work backwards to find the WordPress query that gathered the list of feedback posts to show. I found the query was being performed by a call to &lt;code&gt;get_posts&lt;/code&gt;. After setting the &lt;code&gt;suppress_filters&lt;/code&gt; flag to &lt;code&gt;false&lt;/code&gt; for this query when calling this function, the widget correctly showed posts only for the current language.&lt;/p&gt;
</description>
        <pubDate>Tue, 27 Jan 2015 00:00:00 +0000</pubDate>
        <link>https://www.seanw.org/blog/themes-and-widgets-showing-multiple-languages-wpml</link>
        <guid isPermaLink="true">https://www.seanw.org/blog/themes-and-widgets-showing-multiple-languages-wpml</guid>
        
        
      </item>
    
      <item>
        <title>Hiding visits to your own site in Google Analytics</title>
        <description>&lt;p&gt;When working on a site, it’s common to browse it yourself from multiple browsers, multiple devices and multiple locations for testing purposes. For analytics about your user behaviour to be useful, we need a way to exclude this internal traffic from Google Analytics reports. In this post I explain a method I found useful for hiding visits to your own site when you want to be able to test your site from any browser or any location.&lt;/p&gt;

&lt;p&gt;Google recommends &lt;a href=&quot;https://support.google.com/analytics/answer/1034840?hl=en-GB&quot;&gt;setting up a filter on an IP range&lt;/a&gt; within Google Analytics to filter out internal traffic. This would be a foolproof method if your work IP address is always within a set range but isn’t going to help if you sometimes browse from a different location. However, this method could be used in combination with the following one I prefer.&lt;/p&gt;

&lt;h2 id=&quot;excluding-traffic-using-a-custom-dimension&quot;&gt;Excluding traffic using a custom dimension&lt;/h2&gt;

&lt;p&gt;My preferred method is:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Use a hidden page on your site that you initially browse to that attaches a
&lt;a href=&quot;https://developers.google.com/analytics/devguides/platform/customdimsmets&quot;&gt;custom dimension&lt;/a&gt; to your Google Analytic’s user.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Filter that user’s activity from reports by looking for that custom dimension from within the Google Analytics web interface.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;As well as working from any location, this also has the advantage of letting you confirm analytics activity is being successfully sent unlike approaches that disable the Google Analytics script for internal users altogether. I’ll now explain how to implement the above approach.&lt;/p&gt;

&lt;h2 id=&quot;creating-a-custom-dimension-for-internal-users&quot;&gt;Creating a custom dimension for internal users&lt;/h2&gt;

&lt;p&gt;First you have to create a custom Google Analytics dimension:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Visit the Google Analytics admin panel and select the site you’re working on from the “property” field.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Select “Custom Definitions”, “Custom Dimensions” then “New Custom Dimension”.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Create a new dimension with the name “Internal user” with “Scope” set to “User”. This is the label we’ll use to track internal users.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Take note of the value of the index field that appears next to your new dimension as you’ll need it in the next step.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;a-hidden-page-to-label-you-as-an-internal-user&quot;&gt;A hidden page to label you as an internal user&lt;/h2&gt;

&lt;p&gt;You then need to create a hidden page on your site that sets this dimension for the current user by sending a message to Google Analytics. You can do this with HTML such as the following:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&amp;lt;!DOCTYPE HTML&amp;gt;
&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;meta charset=&quot;UTF-8&quot;&amp;gt;
    &amp;lt;meta name=&quot;robots&quot; content=&quot;noindex,nofollow&quot;/&amp;gt;
    &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
  &amp;lt;/head&amp;gt;
  &amp;lt;body&amp;gt;
    &amp;lt;p&amp;gt;Internal user dimension for Google Analytics set so activity from
    this browser can be filtered. Redirecting to homepage...&amp;lt;/p&amp;gt;

    &amp;lt;script&amp;gt;
      &amp;lt;!-- Standard Google Analytics snippet --&amp;gt;
      (function(i,s,o,g,r,a,m){i[&#39;GoogleAnalyticsObject&#39;]=r;i[r]=i[r]
      ||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
      Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=
      1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,&#39;script&#39;,
      &#39;//www.google-analytics.com/analytics.js&#39;,&#39;ga&#39;);

      ga(&#39;create&#39;, /*YOUR GOOGLE ANALYTICS ID HERE*/, &#39;auto&#39;);
      ga(&#39;require&#39;, &#39;displayfeatures&#39;);
      &amp;lt;!------------------------------&amp;gt;

      ga(&#39;set&#39;, &#39;dimension/*YOUR DIMENSION INDEX HERE*/&#39;, &#39;true&#39;);
      ga(&#39;send&#39;, &#39;pageview&#39;);
      setTimeout(function() { window.location.href = &quot;/&quot;; }, 5000);
    &amp;lt;/script&amp;gt;
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The JavaScript code does the following:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Uses the standard script snippet for loading Google Analytics. You’ll need to update the snippet with your Google Analytics ID.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Sets the “Internal user” dimension for the current user. You’ll need to update the snippet with your dimension index.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Redirects the user back to the homepage after a delay.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;We also set the &lt;code&gt;robots&lt;/code&gt; metatag so web crawlers won’t list this page in search results.&lt;/p&gt;

&lt;h2 id=&quot;excluding-your-custom-dimension-from-reports&quot;&gt;Excluding your custom dimension from reports&lt;/h2&gt;

&lt;p&gt;Next, you need to exclude any users that have the custom dimension attached to them from reports:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;From the Google Analytics admin panel, select “Filters” then “New Filter”.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Set the filter type to “Custom”, set “Filter Field” to “Internal user”, set “Filter Pattern” to “true” then save the filter.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;Now any time you want to browse your own site on a different browser or device, simply go to your hidden page first and your pesky internal traffic will be filtered out of your Google Analytics reports. Hopefully you’ll find this a useful way for eliminating noise from your user analytics.&lt;/p&gt;
</description>
        <pubDate>Thu, 22 Jan 2015 00:00:00 +0000</pubDate>
        <link>https://www.seanw.org/blog/hide-own-traffic-in-google-analytics</link>
        <guid isPermaLink="true">https://www.seanw.org/blog/hide-own-traffic-in-google-analytics</guid>
        
        
      </item>
    
      <item>
        <title>submit-sitemap: Node.js module to submit sitemaps to search engines</title>
        <description>&lt;p&gt;I’ve just uploaded a small &lt;a href=&quot;http://nodejs.org/&quot;&gt;Node.js&lt;/a&gt; module for submitting/pinging sitemaps to search engines called &lt;a href=&quot;https://github.com/seanw/submit-sitemap&quot;&gt;submit-sitemap&lt;/a&gt;. This is meant to be used after you’ve made updates to your site to encourage crawlers to reindex your pages.&lt;/p&gt;

&lt;p&gt;The module currently submits your sitemap to &lt;a href=&quot;http://www.google.com&quot;&gt;Google&lt;/a&gt; and &lt;a href=&quot;http://www.bing.com&quot;&gt;Bing&lt;/a&gt;. This saves you from having to use &lt;a href=&quot;https://support.google.com/sites/answer/100283?hl=en&quot;&gt;Google’s webmaster tools&lt;/a&gt; and &lt;a href=&quot;http://www.bing.com/webmaster/help/how-to-submit-sitemaps-82a15bd4&quot;&gt;Bing’s webmaster tools&lt;/a&gt; to submit your sitemap manually.&lt;/p&gt;

&lt;p&gt;For example, I’ve used this in the last stage of &lt;a href=&quot;http://gulpjs.com/&quot;&gt;Gulp&lt;/a&gt; build scripts that generate and deploy static sites in the following way:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Generate a static site using &lt;a href=&quot;http://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Generate a sitemap file for the static site using &lt;a href=&quot;https://www.npmjs.com/package/gulp-sitemap&quot;&gt;gulp-sitemap&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Upload the site and sitemap to &lt;a href=&quot;https://pages.github.com/&quot;&gt;Github pages&lt;/a&gt; using &lt;a href=&quot;https://github.com/rowoot/gulp-gh-pages&quot;&gt;gulp-gh-pages&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Finally, use submit-sitemap to submit the sitemap to search engines for indexing.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;To install the module:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;npm install submit-sitemap --save-dev
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To submit your sitemap:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;submitSitemap&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;submit-sitemap&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;submitSitemap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;yourSitemapUrl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;https://www.seanw.org/sitemap.xml&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;submitSitemap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;yourSitemapUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The optional callback parameter can be used to respond to success and failure:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;submitSitemap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;yourSitemapUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;On success, &lt;code&gt;err&lt;/code&gt; will be undefined.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;On error, &lt;code&gt;err&lt;/code&gt; will be set to an error message. This happens if the sitemap URL could not be reached or any of the sitemap submission attempts failed.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can find out more about the submit-sitemap module on &lt;a href=&quot;https://www.npmjs.com/package/submit-sitemap&quot;&gt;npmjs.com&lt;/a&gt; and &lt;a href=&quot;https://github.com/seanw/submit-sitemap&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
</description>
        <pubDate>Wed, 21 Jan 2015 00:00:00 +0000</pubDate>
        <link>https://www.seanw.org/blog/submit-sitemap-with-node-js</link>
        <guid isPermaLink="true">https://www.seanw.org/blog/submit-sitemap-with-node-js</guid>
        
        
      </item>
    
  </channel>
</rss>
